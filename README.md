# Route Inspector

**Route Inspector** — скрипт для инвентаризации L3-инфраструктуры Cisco, который автоматически собирает и нормализует информацию о маршрутах, VLAN, SVI и внешних сетях, объединяя данные с маршрутизаторов, core- и access-коммутаторов в единую таблицу.

Инструмент предназначен для получения **читаемого и структурированного представления сетевой адресации**: какие VLAN существуют, какие сети подключены напрямую, какие маршруты внешние, какие шлюзы используются и где именно всё это живёт.

Проект ориентирован на эксплуатацию, аудит и документацию корпоративных сетей.

---

## Требования

- Поддерживаются только устройства Cisco с CLI:
  - IOS
  - IOS-XE
- Для работы требуется **Python 3.x**
- Используемые библиотеки:
  - `netmiko`
  - `prettytable`
  - `tabulate`
- Учетные данные и параметры устройств хранятся в JSON-файлах
- Скрипт предполагает доступ по SSH и возможность входа в enable-режим

---

## Как работает скрипт

### 1. Подключение к устройствам

Route Inspector подключается по SSH к:
- маршрутизатору (router)
- core-коммутатору
- одному или нескольким access-коммутаторам

Список устройств задаётся в конфигурационном файле.

---

### 2. Определение hostname

Hostname каждого устройства извлекается напрямую из CLI prompt (`find_prompt`), без необходимости дополнительных команд.

Hostname **маршрутизатора** используется как:
- логический якорь проекта
- имя итогового CSV-файла

---

### 3. Сбор маршрутов

Из вывода `show ip route` извлекаются:

- **Подключённые сети (C)**  
  Привязываются к VLAN или физическому интерфейсу

- **Локальные маршруты (L)**  
  Используются для выявления loopback и интерфейсных адресов

- **Внешние маршруты**  
  (S, O, B, E1, E2, IA и др.)  
  С указанием next-hop

---

### 4. Работа с VLAN

Скрипт объединяет данные из нескольких источников:

- `show interfaces description`  
  → извлекаются описания VLAN и интерфейсов

- `show vlan brief`  
  → извлекаются имена VLAN (если доступны)

- `show ip interface vlan <VLAN>`  
  → определяется IP-адрес SVI и маска

Если VLAN существует, но не имеет IP — она всё равно попадает в отчёт.

---

### 5. Расчёт параметров подсети

Для каждой сети автоматически вычисляются:
- маска подсети
- wildcard-маска
- диапазон IP-адресов
- количество доступных хостов

---

### 6. Определение шлюза

- Если настроен `ip default-gateway` — используется он
- В противном случае шлюз определяется как первый IP в диапазоне

---

### 7. Объединение данных

Все данные со всех устройств:
- объединяются в одну таблицу
- нормализуются
- при конфликте имён VLAN используется приоритет:
  - core > access > router

---

## Конфигурация

### `switch_config.json`

Файл с описанием устройств инфраструктуры:

```json
{
  "router": {
    "host": "10.106.190.111",
    "port": 22
  },
  "core": {
    "host": "10.106.190.1",
    "port": 22
  },
  "access_sw1": {
    "host": "10.106.190.3",
    "port": 22
  }
}
